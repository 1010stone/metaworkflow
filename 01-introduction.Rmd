# Introduction

Information in living organism commuicates along the Genomics, Transcriptomics, Proteomics and Metabolomics in Central dogma. Following such stream, we might answer certain problems in different scales from individual, population, community to ecosystem. Metabolomics (i.e., the profiling and quantitation of metabolites in body fluids) is a relatively new field of "omics" studies. Different from other omics studies, metabolomics always focused on small moleculars with much lower mass than polypeptide with single or doubled charged ions. Metabolomics studies are always performed in GC-MS, GC*GC-MS[@tian2016], LC-MS, LC-MS/MS or NMR. This workflow would only cover mass spectrometry based metabolomics or XC-MS based research.

## History

### History of Mass Spectrometry

- 1913, Sir Joseph John Thomson "Rays of Positive Electricity and Their Application to Chemical Analyses."

```{r history, fig.show='hold', fig.cap='Sir Joseph John Thomson "Rays of Positive Electricity and Their Application to Chemical Analyses."',echo=FALSE,out.width='90%'}
knitr::include_graphics('images/mshistory.jpg')
```

- Petroleum industry bring mass spectrometry from physics to chemistry

- The first commercial mass spectrometer is from Consolidated Engineering Corp to analysis simple gas mixtures from petroleum

- In World War II, U.S. use mass spectrometer to separate and enrich isotopes of uranium in Manhattan Project

- U.S. also use mass spectrometer for organic compounds during wartime and extend the application of mass spectrometer

- 1946, TOF, William E. Stephens

- 1970s, quadrupole mass analyzer

- 1970s, R. Graham Cooks developed mass-analyzed ion kinetic energy spectrometry, or MIKES to make MRM analysis for multi-stage mass sepctrometry

- 1980s, MALDI rescue TOF and mass spectrometry move into biological application

- 1990s, Orbitrap mass spectrometry

- 2010s, Aperture Coding mass spectrometry

### History of Metabolomcis

According to this book section[@kusonmano2016]:

```{r history2, fig.show='hold', fig.cap='Metabolomics timeline during pre- and post-metabolomics era',echo=FALSE,out.width = '90%'}
knitr::include_graphics('images/metahistory.jpg')
```

- 2000-1500 BC some traditional Chinese doctors who began to evaluate the glucose level in urine of diabetic patients using ants

- 300 BC ancient Egypt and Greece that traditionally determine the urine taste to diagnose human diseases

- 1913 Joseph John Thomson and Francis William Aston mass spectrometry 

- 1946 Felix Bloch and Edward Purcell Nuclear magnetic resonance

- late 1960s chromatographic separation technique

- 1971 Pauling’s research team "Quantitative Analysis of Urine Vapor and Breath by Gas–Liquid Partition Chromatography"

- Willmitzer and his research team pioneer group in metabolomics which suggested the promotion of the metabolomics field and its potential applications from agriculture to medicine and other related areas in the biological sciences

- 2007 Human Metabolome Project consists of databases of approximately 2500 metabolites, 1200 drugs, and 3500 food components

- post-metabolomics era high-throughput analytical techniques 

## Reviews and tutorials

Some new reviews and tutorials related to this workflow could be found in those papers[@alonso2015; @cajka2016; @lu2008; @schrimpe-rutledge2016; @townsend2016; @barnes2016; @barnes2016a].

Also I noticed more and more papers showed a bunch of data process methods as strategy for metabolomics[@watrous2017;@robbatjr.2017]. If you only need metabolomics as tools to tell your story, such stratrgy could be a quick start for you.

For software, check this review[@misra2016].

Here is the slides for metabolomics data analysis workshop and I have made presentations twice in UWaterloo and UC Irvine. Such slides would be updated silent.

- [Introduction](http://yufree.github.io/presentation/metabolomics/introduction#1)

- [Statistical Analysis](http://yufree.github.io/presentation/metabolomics/StatisticalAnalysis#1)

- [Batch Correction](http://yufree.github.io/presentation/metabolomics/BatchCorrection#1)

- [Annotation](http://yufree.github.io/presentation/metabolomics/Annotation#1)

- [Demo](http://yufree.github.io/presentation/metabolomics/demo#1)


## Trends in Metabolomics

```{r gtrends}
library(gtrendsR)
res <- gtrends(c("metabolomics", "metabolomics"), geo = c("CA","US"))
plot(res)
```

```{r rentrez}
library(rentrez)
papers_by_year <- function(years, search_term){
    return(sapply(years, function(y) entrez_search(db="pubmed",term=search_term, mindate=y, maxdate=y, retmax=0)$count))
}
years <- 1987:2017
total_papers <- papers_by_year(years, "")
omics <- c("genomic", "epigenomic", "metabolomics", "metagenomic", "proteomic", "transcriptomic", "pharmacogenomic", "connectomic")
trend_data <- sapply(omics, function(t) papers_by_year(years, t))
trend_props <- trend_data/total_papers
library(reshape)
library(ggplot2)
trend_df <- melt(data.frame(years, trend_data), id.vars="years")
p <- ggplot(trend_df, aes(years, value, colour=variable))
p + geom_line(size=1) + scale_y_log10("number of papers")
```

### Quantitative Metabolomics

Those papers [@kapoore2016b; @jorge2016a].

### High throughput Metabolomics

Those papers [@zampieri2017]

- Cohort size
- Temporal resolution
- Spatial resolution

## Workflow

```{r, echo = F}
DiagrammeR::grViz("digraph workflow {
node [shape = box]
A [label = '@@1']
B [label = '@@2']
C [label = '@@3']
D [label = '@@4']
E [label = '@@5']
F [label = '@@6']
G [label = '@@7']
H [label = '@@8']
I [label = '@@9']
J [label = '@@10']
K [label = '@@11']
L [label = '@@12']
M [label = '@@13']
N [label = '@@14']
O [label = '@@15']

A -> B -> C -> D -> E -> F -> G -> H
H -> I
I -> J
H -> J -> K -> L
L -> M -> N
L -> O
                  }

[1]: 'Raw data'
[2]: 'mzxml or CDF'
[3]: 'DoE folder'
[4]: 'peaks list'
[5]: 'retention time correction'
[6]: 'peaks grouping'
[7]: 'peaks filling'
[8]: 'raw peaks'
[9]: 'data visulization'
[10]: 'batch effects correction'
[11]: 'corrected peaks'
[12]: 'annotation'
[13]: 'metabolomics pathway analysis'
[14]: 'omics analysis'
[15]: 'biomarkers discovery/diagnoise'

                  ",width = 300)
```